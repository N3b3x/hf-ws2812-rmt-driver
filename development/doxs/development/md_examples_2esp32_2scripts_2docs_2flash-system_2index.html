<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HF-WS2812 Driver: ESP-IDF Flash System Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HF-WS2812 Driver<span id="projectnumber">&#160;0.1.0-dev</span>
   </div>
   <div id="projectbrief">HF-WS2812 ESP32 RMT Driver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_examples_2esp32_2scripts_2docs_2flash-system_2index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">ESP-IDF Flash System Guide</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md374"></a> This document provides comprehensive documentation for the ESP-IDF flash system, including port detection, firmware flashing, monitoring, and troubleshooting.</p>
<h1><a class="anchor" id="autotoc_md375"></a>
üìã <b>Table of Contents</b></h1>
<h1><a class="anchor" id="autotoc_md376"></a>
üìã <b>Overview</b></h1>
<p>The ESP-IDF flash system is a comprehensive solution for firmware deployment, device monitoring, and development workflow management. It provides intelligent port detection, robust flashing operations, and integrated logging for professional ESP-IDF development.</p>
<h2><a class="anchor" id="autotoc_md377"></a>
<b>Core Features</b></h2>
<ul>
<li><b>Intelligent Port Detection</b>: Automatic ESP32 device identification across platforms</li>
<li><b>Operation-First Syntax</b>: Intuitive command structure for better usability</li>
<li><b>Comprehensive Logging</b>: Built-in logging system with automatic rotation</li>
<li><b>Cross-Platform Compatibility</b>: Consistent behavior on Linux and macOS</li>
<li><b>Error Prevention</b>: Validation and error handling with clear troubleshooting guidance</li>
</ul>
<h2><a class="anchor" id="autotoc_md378"></a>
<b>Key Capabilities</b></h2>
<ul>
<li>Automatic ESP32 device detection and port identification</li>
<li>Firmware flashing with validation and error checking</li>
<li>Real-time device monitoring and debugging</li>
<li>Integrated logging and log management</li>
<li>Port connectivity testing and troubleshooting</li>
<li>Cross-platform serial port management</li>
</ul>
<h1><a class="anchor" id="autotoc_md379"></a>
üèóÔ∏è <b>Architecture and Design</b></h1>
<h2><a class="anchor" id="autotoc_md380"></a>
<b>System Architecture</b></h2>
<div class="fragment"><div class="line">User Commands ‚Üí flash_app.sh ‚Üí Port Detection ‚Üí ESP-IDF Tools ‚Üí Device Communication</div>
<div class="line">     ‚Üì              ‚Üì              ‚Üì              ‚Üì              ‚Üì</div>
<div class="line">Operation      Parameter      Device ID      Flash/Monitor   Serial I/O</div>
<div class="line">Specification  Validation     &amp; Port         Commands        &amp; Control</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md381"></a>
<b>Component Interaction</b></h2>
<ul>
<li>**<code>flash_app.sh</code>**: Main flash orchestration script</li>
<li>**<code>detect_ports.sh</code>**: Port detection and device identification</li>
<li>**<code>manage_logs.sh</code>**: Logging system integration</li>
<li><b>ESP-IDF Tools</b>: esptool, idf.py for device communication</li>
<li><b>Serial Port Management</b>: Cross-platform port access and control</li>
</ul>
<h2><a class="anchor" id="autotoc_md382"></a>
<b>Design Principles</b></h2>
<ul>
<li><b>Operation-First</b>: Commands start with the operation for clarity</li>
<li><b>Intelligent Defaults</b>: Sensible fallbacks when parameters are omitted</li>
<li><b>Fail-Safe Operations</b>: Validation before execution to prevent errors</li>
<li><b>Cross-Platform Consistency</b>: Uniform behavior across operating systems</li>
<li><b>User Experience</b>: Clear error messages and troubleshooting guidance</li>
</ul>
<h1><a class="anchor" id="autotoc_md383"></a>
üîå <b>Port Detection and Management</b></h1>
<h2><a class="anchor" id="autotoc_md384"></a>
<b>Automatic Device Detection</b></h2>
<h3><a class="anchor" id="autotoc_md385"></a>
<b>Cross-Platform Detection</b></h3>
<p>The flash system automatically detects ESP32 devices across different platforms:</p>
<p><b>Linux Detection</b>: </p><div class="fragment"><div class="line">## USB serial devices</div>
<div class="line">/dev/ttyUSB0, /dev/ttyUSB1, /dev/ttyACM0</div>
<div class="line"> </div>
<div class="line">## ESP32-specific patterns</div>
<div class="line">/dev/ttyUSB* (CP210x, CH340, FTDI)</div>
<div class="line">/dev/ttyACM* (CDC ACM devices)</div>
</div><!-- fragment --><p> <b>macOS Detection</b>: </p><div class="fragment"><div class="line">## USB serial devices</div>
<div class="line">/dev/cu.usbserial-*, /dev/cu.SLAB_USBtoUART*</div>
<div class="line"> </div>
<div class="line">## ESP32-specific patterns</div>
<div class="line">/dev/cu.usbmodem*, /dev/cu.usbserial*</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md386"></a>
<b>Device Identification Patterns</b></h3>
<p>The system recognizes common ESP32 development board USB identifiers:</p>
<div class="fragment"><div class="line">## Common ESP32 USB identifiers</div>
<div class="line">CP210x: Silicon Labs CP210x USB to UART Bridge</div>
<div class="line">CH340: WCH CH340 USB to Serial</div>
<div class="line">FTDI: FTDI FT232R USB UART</div>
<div class="line">CDC ACM: USB CDC ACM devices</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md387"></a>
<b>Port Validation and Testing</b></h2>
<h3><a class="anchor" id="autotoc_md388"></a>
<b>Connectivity Testing</b></h3>
<div class="fragment"><div class="line">## Test port connectivity</div>
<div class="line">./detect_ports.sh --test-connection</div>
<div class="line"> </div>
<div class="line">## Verify port accessibility</div>
<div class="line">./detect_ports.sh --verbose</div>
<div class="line"> </div>
<div class="line">## Check port permissions and status</div>
<div class="line">./detect_ports.sh --verbose --test-connection</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md389"></a>
<b>Permission Management</b></h3>
<p>The system handles common permission issues:</p>
<div class="fragment"><div class="line">## Linux udev rules for ESP32 devices</div>
<div class="line">SUBSYSTEM==&quot;tty&quot;, ATTRS{idVendor}==&quot;10c4&quot;, ATTRS{idProduct}==&quot;ea60&quot;, MODE=&quot;0666&quot;</div>
<div class="line">SUBSYSTEM==&quot;tty&quot;, ATTRS{idVendor}==&quot;1a86&quot;, ATTRS{idProduct}==&quot;7523&quot;, MODE=&quot;0666&quot;</div>
<div class="line"> </div>
<div class="line">## User group membership</div>
<div class="line">sudo usermod -a -G dialout $USER</div>
<div class="line">sudo usermod -a -G tty $USER</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md390"></a>
<b>Port Selection Logic</b></h2>
<h3><a class="anchor" id="autotoc_md391"></a>
<b>Automatic Port Selection</b></h3>
<p>When multiple ports are available, the system uses intelligent selection:</p>
<div class="fragment"><div class="line">## Priority order for port selection</div>
<div class="line">1. ESP32-specific USB identifiers (CP210x, CH340, FTDI)</div>
<div class="line">2. Previously used ports (from configuration)</div>
<div class="line">3. First available USB serial port</div>
<div class="line">4. Fallback to manual selection</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md392"></a>
<b>Manual Port Override</b></h3>
<div class="fragment"><div class="line">## Override automatic port detection</div>
<div class="line">export ESPPORT=&quot;/dev/ttyUSB0&quot;</div>
<div class="line">./flash_app.sh flash gpio_test Release</div>
<div class="line"> </div>
<div class="line">## Specify port in command</div>
<div class="line">./flash_app.sh flash gpio_test Release --port /dev/ttyUSB1</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md393"></a>
‚ö° <b>Flash Operations and Workflows</b></h1>
<h2><a class="anchor" id="autotoc_md394"></a>
<b>Operation Types</b></h2>
<h3><a class="anchor" id="autotoc_md395"></a>
<b>1. Flash Operations</b></h3>
<ul>
<li>**<code>flash</code>**: Flash firmware only (no monitoring)</li>
<li>**<code>flash_monitor</code>**: Flash firmware and start monitoring (default)</li>
<li>**<code>monitor</code>**: Monitor existing firmware (no flashing)</li>
<li>**<code>size</code>**: Show firmware size information and memory usage analysis</li>
<li>**<code>list</code>**: List available applications and configurations</li>
</ul>
<h3><a class="anchor" id="autotoc_md396"></a>
<b>2. Operation Syntax</b></h3>
<p>The system supports both operation-first and legacy syntax:</p>
<div class="fragment"><div class="line">## Operation-first syntax (RECOMMENDED)</div>
<div class="line">./flash_app.sh flash gpio_test Release</div>
<div class="line">./flash_app.sh monitor --log</div>
<div class="line">./flash_app.sh flash_monitor adc_test Debug</div>
<div class="line">./flash_app.sh size gpio_test Release</div>
<div class="line">./flash_app.sh size gpio_test Release release/v5.5</div>
<div class="line"> </div>
<div class="line">## Legacy syntax (still supported)</div>
<div class="line">./flash_app.sh gpio_test Release flash</div>
<div class="line">./flash_app.sh gpio_test Release flash_monitor</div>
<div class="line">./flash_app.sh gpio_test Release size</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md397"></a>
<b>Flash Process Workflow</b></h2>
<h3><a class="anchor" id="autotoc_md398"></a>
<b>1. Pre-Flash Validation</b></h3>
<div class="fragment"><div class="line">## Validate configuration</div>
<div class="line">- Check app exists in configuration</div>
<div class="line">- Verify build type support</div>
<div class="line">- Validate ESP-IDF version compatibility</div>
<div class="line">- Confirm target device compatibility</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md399"></a>
<b>2. Port Detection and Selection</b></h3>
<div class="fragment"><div class="line">## Automatic port detection</div>
<div class="line">- Scan for available ESP32 devices</div>
<div class="line">- Identify compatible ports</div>
<div class="line">- Test port connectivity</div>
<div class="line">- Select optimal port for operation</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md400"></a>
<b>3. Flash Execution</b></h3>
<div class="fragment"><div class="line">## ESP-IDF flash process</div>
<div class="line">- Set target MCU (esp32c6)</div>
<div class="line">- Configure flash parameters</div>
<div class="line">- Execute flash operation</div>
<div class="line">- Validate flash completion</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md401"></a>
<b>4. Post-Flash Operations</b></h3>
<div class="fragment"><div class="line">## Post-flash actions</div>
<div class="line">- Verify firmware integrity</div>
<div class="line">- Start monitoring (if requested)</div>
<div class="line">- Generate operation logs</div>
<div class="line">- Update port configuration</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md402"></a>
<b>Flash Configuration Options</b></h2>
<h3><a class="anchor" id="autotoc_md403"></a>
<b>Build Type Integration</b></h3>
<div class="fragment"><div class="line">## Flash with specific build type</div>
<div class="line">./flash_app.sh flash gpio_test Release</div>
<div class="line">./flash_app.sh flash gpio_test Debug</div>
<div class="line"> </div>
<div class="line">## Automatic build type validation</div>
<div class="line">- Ensures build type is supported by app</div>
<div class="line">- Validates against app_config.yml configuration</div>
<div class="line">- Provides clear error messages for incompatibilities</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md404"></a>
<b>ESP-IDF Version Support</b></h3>
<div class="fragment"><div class="line">## Flash with specific ESP-IDF version</div>
<div class="line">./flash_app.sh flash gpio_test Release release/v5.5</div>
<div class="line">./flash_app.sh flash gpio_test Release release/v5.4</div>
<div class="line"> </div>
<div class="line">## Version compatibility validation</div>
<div class="line">- Checks app support for specified version</div>
<div class="line">- Validates against app configuration</div>
<div class="line">- Ensures consistent toolchain usage</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md405"></a>
<b>Size Analysis Operations</b></h3>
<p>The size operation provides comprehensive firmware analysis without requiring device connection:</p>
<div class="fragment"><div class="line">## Basic size analysis</div>
<div class="line">./flash_app.sh size gpio_test Release</div>
<div class="line"> </div>
<div class="line">## Size analysis with specific ESP-IDF version</div>
<div class="line">./flash_app.sh size gpio_test Release release/v5.5</div>
<div class="line"> </div>
<div class="line">## Size analysis with app-first syntax</div>
<div class="line">./flash_app.sh gpio_test Release size</div>
</div><!-- fragment --><p> <b>Size Operation Features</b>:</p><ul>
<li><b>Firmware Size Analysis</b>: Total image size and memory usage breakdown</li>
<li><b>Component Size Breakdown</b>: Per-archive contributions to ELF file</li>
<li><b>Memory Usage Summary</b>: Flash, DIRAM, and LP SRAM usage analysis</li>
<li><b>Build Validation</b>: Ensures build exists before analysis</li>
<li><b>No Port Required</b>: Works without device connection</li>
<li><b>Smart Build Detection</b>: Automatically finds correct build directory</li>
</ul>
<h1><a class="anchor" id="autotoc_md406"></a>
üì∫ <b>Monitoring and Logging</b></h1>
<h2><a class="anchor" id="autotoc_md407"></a>
<b>Integrated Logging System</b></h2>
<h3><a class="anchor" id="autotoc_md408"></a>
<b>Log Generation</b></h3>
<p>The flash system automatically generates comprehensive logs:</p>
<div class="fragment"><div class="line">## Automatic log creation</div>
<div class="line">./flash_app.sh flash_monitor gpio_test Release --log</div>
<div class="line"> </div>
<div class="line">## Log file naming convention</div>
<div class="line">gpio_test_Release_20250115_143022.log</div>
<div class="line">## Format: {app}*{build_type}*{date}*{time}.log</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md409"></a>
<b>Log Content and Structure</b></h3>
<div class="fragment"><div class="line">## Log file contents</div>
<div class="line">- Command execution details</div>
<div class="line">- Port detection results</div>
<div class="line">- Flash operation output</div>
<div class="line">- Monitor session data</div>
<div class="line">- Error messages and warnings</div>
<div class="line">- Performance metrics</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md410"></a>
<b>Monitoring Capabilities</b></h2>
<h3><a class="anchor" id="autotoc_md411"></a>
<b>Real-Time Monitoring</b></h3>
<div class="fragment"><div class="line">## Start monitoring after flash</div>
<div class="line">./flash_app.sh flash_monitor gpio_test Release --log</div>
<div class="line"> </div>
<div class="line">## Monitor existing firmware</div>
<div class="line">./flash_app.sh monitor --log</div>
<div class="line"> </div>
<div class="line">## Monitor with custom log name</div>
<div class="line">./flash_app.sh monitor --log debug_session</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md412"></a>
<b>Monitor Configuration</b></h3>
<div class="fragment"><div class="line">## Monitor options</div>
<div class="line">- Baud rate: 115200 (configurable)</div>
<div class="line">- Data bits: 8</div>
<div class="line">- Parity: None</div>
<div class="line">- Stop bits: 1</div>
<div class="line">- Flow control: None</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md413"></a>
<b>Log Management Integration</b></h2>
<h3><a class="anchor" id="autotoc_md414"></a>
<b>Automatic Log Rotation</b></h3>
<div class="fragment"><div class="line">## Log rotation features</div>
<div class="line">- Timestamped log files</div>
<div class="line">- Automatic log directory management</div>
<div class="line">- Configurable retention policies</div>
<div class="line">- Storage optimization</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md415"></a>
<b>Log Analysis Tools</b></h3>
<div class="fragment"><div class="line">## Integrated log management</div>
<div class="line">./manage_logs.sh list          # List all logs</div>
<div class="line">./manage_logs.sh latest        # Show latest log</div>
<div class="line">./manage_logs.sh search &quot;ERROR&quot; # Search for errors</div>
<div class="line">./manage_logs.sh stats         # Log statistics</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md416"></a>
üöÄ <b>Usage Examples and Patterns</b></h1>
<h2><a class="anchor" id="autotoc_md417"></a>
<b>Basic Flash Workflows</b></h2>
<h3><a class="anchor" id="autotoc_md418"></a>
<b>1. Development Flash Workflow</b></h3>
<div class="fragment"><div class="line">## Build and flash for development</div>
<div class="line">./build_app.sh gpio_test Debug</div>
<div class="line">./flash_app.sh flash_monitor gpio_test Debug --log</div>
<div class="line"> </div>
<div class="line">## Expected result:</div>
<div class="line">## - Firmware flashed to device</div>
<div class="line">## - Monitoring started automatically</div>
<div class="line">## - Debug output captured in logs</div>
<div class="line">## - Real-time debugging available</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md419"></a>
<b>2. Production Flash Workflow</b></h3>
<div class="fragment"><div class="line">## Build and flash for production</div>
<div class="line">./build_app.sh gpio_test Release</div>
<div class="line">./flash_app.sh flash gpio_test Release --log production_deploy</div>
<div class="line"> </div>
<div class="line">## Expected result:</div>
<div class="line">## - Optimized firmware flashed</div>
<div class="line">## - No monitoring (production mode)</div>
<div class="line">## - Deployment log generated</div>
<div class="line">## - Ready for production use</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md420"></a>
<b>3. Portable Flash Usage</b></h3>
<div class="fragment"><div class="line">## Default behavior (scripts in project/scripts/)</div>
<div class="line">./flash_app.sh flash_monitor gpio_test Release</div>
<div class="line"> </div>
<div class="line">## Portable usage with --project-path</div>
<div class="line">./flash_app.sh --project-path /path/to/project flash_monitor gpio_test Release</div>
<div class="line">./flash_app.sh --project-path ../project flash adc_test Debug --log</div>
<div class="line"> </div>
<div class="line">## Environment variable usage</div>
<div class="line">export PROJECT_PATH=/path/to/project</div>
<div class="line">./flash_app.sh flash_monitor gpio_test Release</div>
<div class="line"> </div>
<div class="line">## Multiple project support</div>
<div class="line">./flash_app.sh --project-path ~/projects/robot-controller flash_monitor gpio_test Release</div>
<div class="line">./flash_app.sh --project-path ~/projects/sensor-node flash adc_test Debug</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md421"></a>
<b>4. Debugging Workflow</b></h3>
<div class="fragment"><div class="line">## Monitor existing firmware</div>
<div class="line">./flash_app.sh monitor --log debug_session</div>
<div class="line"> </div>
<div class="line">## Search for issues</div>
<div class="line">./manage_logs.sh search &quot;ERROR&quot;</div>
<div class="line">./manage_logs.sh search &quot;WARNING&quot;</div>
<div class="line"> </div>
<div class="line">## Analyze log patterns</div>
<div class="line">./manage_logs.sh stats</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md422"></a>
<b>4. Size Analysis Workflow</b></h3>
<div class="fragment"><div class="line">## Analyze firmware size before deployment</div>
<div class="line">./flash_app.sh size gpio_test Release</div>
<div class="line"> </div>
<div class="line">## Check memory usage for optimization</div>
<div class="line">./flash_app.sh size gpio_test Debug</div>
<div class="line"> </div>
<div class="line">## Compare sizes between versions</div>
<div class="line">./flash_app.sh size gpio_test Release release/v5.5</div>
<div class="line">./flash_app.sh size gpio_test Release release/v5.4</div>
<div class="line"> </div>
<div class="line">## Expected result:</div>
<div class="line">## - Comprehensive size analysis</div>
<div class="line">## - Component breakdown</div>
<div class="line">## - Memory usage summary</div>
<div class="line">## - No device connection required</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md423"></a>
<b>Advanced Flash Patterns</b></h2>
<h3><a class="anchor" id="autotoc_md424"></a>
<b>1. Multi-Device Deployment</b></h3>
<div class="fragment"><div class="line">## Flash to multiple devices</div>
<div class="line">for port in /dev/ttyUSB0 /dev/ttyUSB1 /dev/ttyUSB2; do</div>
<div class="line">    export ESPPORT=&quot;$port&quot;</div>
<div class="line">    ./flash_app.sh flash gpio_test Release --log &quot;deploy*${port}&quot;</div>
<div class="line">done</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md425"></a>
<b>2. Conditional Flash Operations</b></h3>
<div class="fragment"><div class="line">## Flash only if build is newer</div>
<div class="line">if [ &quot;build_gpio_test_Release/gpio_test.bin&quot; -nt &quot;last_flash&quot; ]; then</div>
<div class="line">    ./flash_app.sh flash gpio_test Release --log</div>
<div class="line">    touch last_flash</div>
<div class="line">fi</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md426"></a>
<b>3. Automated Testing Flash</b></h3>
<div class="fragment"><div class="line">## Flash for automated testing</div>
<div class="line">./flash_app.sh flash gpio_test Release --log &quot;test*$(date +%Y%m%d*%H%M%S)&quot;</div>
<div class="line"> </div>
<div class="line">## Run automated tests</div>
<div class="line">## Monitor test results</div>
<div class="line">## Collect test logs</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md427"></a>
<b>Integration with Build System</b></h2>
<h3><a class="anchor" id="autotoc_md428"></a>
<b>Build-Flash Integration</b></h3>
<div class="fragment"><div class="line">## Combined build and flash</div>
<div class="line">./build_app.sh gpio_test Release &amp;&amp; \</div>
<div class="line">./flash_app.sh flash_monitor gpio_test Release --log</div>
<div class="line"> </div>
<div class="line">## Automatic build verification</div>
<div class="line">- Ensures build exists before flashing</div>
<div class="line">- Validates build type compatibility</div>
<div class="line">- Checks firmware integrity</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md429"></a>
<b>CI/CD Integration</b></h3>
<div class="fragment"><div class="line">## GitHub Actions flash workflow</div>
<div class="line">- name: Flash ESP32 Application</div>
<div class="line">  run: |</div>
<div class="line">    cd /examples/esp32</div>
<div class="line">    ./scripts/flash_app.sh flash gpio_test Release --log ci_deploy</div>
<div class="line"> </div>
<div class="line">- name: Verify Flash</div>
<div class="line">  run: |</div>
<div class="line">    ./scripts/flash_app.sh monitor --log ci_verify</div>
<div class="line">    timeout 30s ./scripts/flash_app.sh monitor --log ci_verify</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md430"></a>
üîç <b>Troubleshooting and Debugging</b></h1>
<h2><a class="anchor" id="autotoc_md431"></a>
<b>Common Flash Issues</b></h2>
<h3><a class="anchor" id="autotoc_md432"></a>
<b>1. Port Detection Issues</b></h3>
<p><b>Problem</b>: No ESP32 devices detected <b>Symptoms</b>: "No ports detected" or "Port not accessible" errors <b>Solutions</b>: </p><div class="fragment"><div class="line">## Check device connections</div>
<div class="line">./detect_ports.sh --verbose</div>
<div class="line"> </div>
<div class="line">## Test port connectivity</div>
<div class="line">./detect_ports.sh --test-connection</div>
<div class="line"> </div>
<div class="line">## Verify USB drivers</div>
<div class="line">lsusb | grep -i esp</div>
<div class="line">system_profiler SPUSBDataType | grep -i esp</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md433"></a>
<b>2. Permission Issues</b></h3>
<p><b>Problem</b>: Port access denied <b>Symptoms</b>: "Permission denied" or "Access denied" errors <b>Solutions</b>: </p><div class="fragment"><div class="line">## Check user permissions</div>
<div class="line">ls -la /dev/ttyUSB*</div>
<div class="line">groups $USER</div>
<div class="line"> </div>
<div class="line">## Add user to required groups</div>
<div class="line">sudo usermod -a -G dialout,tty $USER</div>
<div class="line"> </div>
<div class="line">## Create udev rules</div>
<div class="line">sudo nano /etc/udev/rules.d/99-esp32.rules</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md434"></a>
<b>3. Flash Failures</b></h3>
<p><b>Problem</b>: Firmware flash fails <b>Symptoms</b>: "Flash failed" or "Upload failed" errors <b>Solutions</b>: </p><div class="fragment"><div class="line">## Check device connection</div>
<div class="line">./detect_ports.sh --test-connection</div>
<div class="line"> </div>
<div class="line">## Verify firmware file</div>
<div class="line">ls -la build_gpio_test_Release/*.bin</div>
<div class="line"> </div>
<div class="line">## Check device mode</div>
<div class="line">./flash_app.sh monitor --log flash_debug</div>
<div class="line"> </div>
<div class="line">## Reset device and retry</div>
<div class="line">## Hold BOOT button during flash</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md435"></a>
<b>4. Monitor Issues</b></h3>
<p><b>Problem</b>: Cannot monitor device <b>Symptoms</b>: "Monitor failed" or "No output" errors <b>Solutions</b>: </p><div class="fragment"><div class="line">## Check baud rate compatibility</div>
<div class="line">./flash_app.sh monitor --log</div>
<div class="line"> </div>
<div class="line">## Verify device is running</div>
<div class="line">./flash_app.sh monitor --log debug_monitor</div>
<div class="line"> </div>
<div class="line">## Check for bootloader mode</div>
<div class="line">## Press RESET button to restart</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md436"></a>
<b>Debug and Verbose Mode</b></h2>
<h3><a class="anchor" id="autotoc_md437"></a>
<b>Enabling Debug Output</b></h3>
<div class="fragment"><div class="line">## Enable debug mode</div>
<div class="line">export DEBUG=1</div>
<div class="line">./flash_app.sh flash_monitor gpio_test Release --log</div>
<div class="line"> </div>
<div class="line">## Enable verbose ESP-IDF output</div>
<div class="line">export IDF_VERBOSE=1</div>
<div class="line">./flash_app.sh flash gpio_test Release --log</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md438"></a>
<b>Debug Information Available</b></h3>
<ul>
<li>Port detection and selection details</li>
<li>Flash operation progress and status</li>
<li>Monitor session configuration</li>
<li>Error context and troubleshooting suggestions</li>
<li>Performance metrics and timing</li>
</ul>
<h2><a class="anchor" id="autotoc_md439"></a>
<b>Log Analysis for Troubleshooting</b></h2>
<h3><a class="anchor" id="autotoc_md440"></a>
<b>Flash Log Analysis</b></h3>
<div class="fragment"><div class="line">## Check flash operation logs</div>
<div class="line">./manage_logs.sh latest</div>
<div class="line">./manage_logs.sh search &quot;ERROR&quot;</div>
<div class="line">./manage_logs.sh search &quot;FAILED&quot;</div>
<div class="line"> </div>
<div class="line">## Analyze flash patterns</div>
<div class="line">./manage_logs.sh search &quot;Flash completed&quot;</div>
<div class="line">./manage_logs.sh search &quot;Upload failed&quot;</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md441"></a>
<b>Monitor Log Analysis</b></h3>
<div class="fragment"><div class="line">## Check monitor session logs</div>
<div class="line">./manage_logs.sh search &quot;monitor&quot;</div>
<div class="line">./manage_logs.sh search &quot;serial&quot;</div>
<div class="line"> </div>
<div class="line">## Analyze device output</div>
<div class="line">./manage_logs.sh search &quot;ESP32&quot;</div>
<div class="line">./manage_logs.sh search &quot;boot&quot;</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md442"></a>
üìö <b>Reference and Examples</b></h1>
<h2><a class="anchor" id="autotoc_md443"></a>
<b>Command Reference</b></h2>
<h3><a class="anchor" id="autotoc_md444"></a>
<b>Flash Script Parameters</b></h3>
<div class="fragment"><div class="line">./flash_app.sh [operation] [app_type] [build_type] [idf_version] [options]</div>
<div class="line"> </div>
<div class="line">## Parameters:</div>
<div class="line">##   operation    - What to do (flash, monitor, flash_monitor, list)</div>
<div class="line">##   app_type     - Application to flash (from app_config.yml)</div>
<div class="line">##   build_type   - Build type to flash (Debug, Release)</div>
<div class="line">##   idf_version  - ESP-IDF version used for build</div>
<div class="line">##   options      - Flash options (--log, --port, etc.)</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md445"></a>
<b>Flash Options</b></h3>
<ul>
<li>**<code>--log [name]</code>**: Enable logging with optional custom name</li>
<li>**<code>--port &lt;port&gt;</code>**: Override automatic port detection</li>
<li>**<code>--baud &lt;rate&gt;</code>**: Set custom baud rate for monitoring</li>
<li>**<code>--help</code>**: Show usage information</li>
<li>**<code>list</code>**: List available applications and configurations</li>
</ul>
<h3><a class="anchor" id="autotoc_md446"></a>
<b>Environment Variables</b></h3>
<div class="fragment"><div class="line">## Override default application</div>
<div class="line">export CONFIG_DEFAULT_APP=&quot;gpio_test&quot;</div>
<div class="line"> </div>
<div class="line">## Override default build type</div>
<div class="line">export CONFIG_DEFAULT_BUILD_TYPE=&quot;Debug&quot;</div>
<div class="line"> </div>
<div class="line">## Override default ESP-IDF version</div>
<div class="line">export CONFIG_DEFAULT_IDF_VERSION=&quot;release/v5.4&quot;</div>
<div class="line"> </div>
<div class="line">## Override port detection</div>
<div class="line">export ESPPORT=&quot;/dev/ttyUSB0&quot;</div>
<div class="line"> </div>
<div class="line">## Enable debug mode</div>
<div class="line">export DEBUG=1</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md447"></a>
<b>Configuration Examples</b></h2>
<h3><a class="anchor" id="autotoc_md448"></a>
<b>Minimal Flash Configuration</b></h3>
<div class="fragment"><div class="line">## app_config.yml minimal configuration</div>
<div class="line">metadata:</div>
<div class="line">  default_app: &quot;gpio_test&quot;</div>
<div class="line">  default_build_type: &quot;Release&quot;</div>
<div class="line">  target: &quot;esp32c6&quot;</div>
<div class="line"> </div>
<div class="line">apps:</div>
<div class="line">  gpio_test:</div>
<div class="line">    source_file: &quot;GpioComprehensiveTest.cpp&quot;</div>
<div class="line">    build_types: [&quot;Debug&quot;, &quot;Release&quot;]</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md449"></a>
<b>Advanced Flash Configuration</b></h3>
<div class="fragment"><div class="line">## app_config.yml advanced configuration</div>
<div class="line">metadata:</div>
<div class="line">  default_app: &quot;gpio_test&quot;</div>
<div class="line">  default_build_type: &quot;Release&quot;</div>
<div class="line">  target: &quot;esp32c6&quot;</div>
<div class="line">  idf_versions: [&quot;release/v5.5&quot;, &quot;release/v5.4&quot;]</div>
<div class="line"> </div>
<div class="line">apps:</div>
<div class="line">  gpio_test:</div>
<div class="line">    description: &quot;GPIO testing application&quot;</div>
<div class="line">    source_file: &quot;GpioComprehensiveTest.cpp&quot;</div>
<div class="line">    category: &quot;peripheral&quot;</div>
<div class="line">    build_types: [&quot;Debug&quot;, &quot;Release&quot;]</div>
<div class="line">    idf_versions: [&quot;release/v5.5&quot;]</div>
<div class="line">    ci_enabled: true</div>
<div class="line">    featured: true</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md450"></a>
<b>Integration Examples</b></h2>
<h3><a class="anchor" id="autotoc_md451"></a>
<b>CMake Integration</b></h3>
<div class="fragment"><div class="line">## CMakeLists.txt flash integration</div>
<div class="line">cmake_minimum_required(VERSION 3.16)</div>
<div class="line"> </div>
<div class="line">## Flash target integration</div>
<div class="line">add_custom_target(flash</div>
<div class="line">    COMMAND ${CMAKE_SOURCE_DIR}/scripts/flash_app.sh flash ${APP_TYPE} ${BUILD_TYPE}</div>
<div class="line">    DEPENDS ${PROJECT_NAME}</div>
<div class="line">    COMMENT &quot;Flashing ${APP_TYPE} ${BUILD_TYPE} to device&quot;</div>
<div class="line">)</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md452"></a>
<b>CI/CD Integration</b></h3>
<div class="fragment"><div class="line">## GitHub Actions flash workflow</div>
<div class="line">- name: Flash ESP32 Application</div>
<div class="line">  run: |</div>
<div class="line">    cd /examples/esp32</div>
<div class="line">    ./scripts/flash_app.sh flash gpio_test Release --log ci_deploy</div>
<div class="line"> </div>
<div class="line">- name: Verify Flash</div>
<div class="line">  run: |</div>
<div class="line">    ./scripts/flash_app.sh monitor --log ci_verify</div>
<div class="line">    timeout 30s ./scripts/flash_app.sh monitor --log ci_verify</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md453"></a>
<b>Best Practices</b></h2>
<h3><a class="anchor" id="autotoc_md454"></a>
<b>1. Flash Operations</b></h3>
<ul>
<li>Always use logging for debugging and troubleshooting</li>
<li>Verify device connections before flashing</li>
<li>Use appropriate build types for different purposes</li>
<li>Test flash operations in development before production</li>
</ul>
<h3><a class="anchor" id="autotoc_md455"></a>
<b>2. Port Management</b></h3>
<ul>
<li>Use automatic port detection when possible</li>
<li>Verify port permissions and access rights</li>
<li>Test port connectivity before operations</li>
<li>Handle multiple device scenarios gracefully</li>
</ul>
<h3><a class="anchor" id="autotoc_md456"></a>
<b>3. Error Handling</b></h3>
<ul>
<li>Always check flash operation results</li>
<li>Use debug mode for troubleshooting</li>
<li>Analyze logs for error patterns</li>
<li>Implement proper error handling in automation</li>
</ul>
<h3><a class="anchor" id="autotoc_md457"></a>
<b>4. Performance Optimization</b></h3>
<ul>
<li>Use appropriate flash parameters</li>
<li>Optimize monitor settings for your use case</li>
<li>Regular log maintenance and cleanup</li>
<li>Monitor flash performance and reliability </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
